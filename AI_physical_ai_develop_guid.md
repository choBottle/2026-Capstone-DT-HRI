# [AI Team] Model Training & Inference Integration Guide

ì´ ë¬¸ì„œëŠ” AIíŒ€ì´ DBì—ì„œ ë°ì´í„°ë¥¼ ì¶”ì¶œí•˜ì—¬ í•™ìŠµì„ ì§„í–‰í•˜ê³ , ì™„ì„±ëœ ëª¨ë¸ì„ **Brain Worker** ë‹¨ê³„ì— í†µí•©í•˜ê¸° ìœ„í•œ ê°€ì´ë“œìž…ë‹ˆë‹¤.

## 1. ë°ì´í„° íë¦„ê³¼ AIì˜ ìœ„ì¹˜

ìš°ë¦¬ ì‹œìŠ¤í…œì—ì„œ AIëŠ” ì£¼ë¡œ **Brain Worker** ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì— íƒ‘ìž¬ë˜ê±°ë‚˜, ë³„ë„ì˜ **AI Inference ì„œë²„**ë¡œ ë™ìž‘í•©ë‹ˆë‹¤.

- **í•™ìŠµ(Training):** DBíŒ€ì´ êµ¬ì¶•í•œ `robot_telemetry` í…Œì´ë¸”ì—ì„œ ê³¼ê±° ë°ì´í„°ë¥¼ ê°€ì ¸ì™€ ëª¨ë¸ì„ í•™ìŠµì‹œí‚µë‹ˆë‹¤.
- **ì¶”ë¡ (Inference):** ë¦´ë ˆì´ë¡œë¶€í„° ë“¤ì–´ì˜¤ëŠ” ì‹¤ì‹œê°„ Raw ë°ì´í„°ë¥¼ ëª¨ë¸ì— ìž…ë ¥í•˜ì—¬ ë¡œë´‡ì˜ ë‹¤ìŒ í–‰ë™ì„ ì˜ˆì¸¡í•˜ê±°ë‚˜ ìƒíƒœë¥¼ ì§„ë‹¨í•©ë‹ˆë‹¤.

## 2. AI íŒ€ì˜ ì£¼ìš” ìž‘ì—… ì˜ì—­

### **A. í•™ìŠµ ë°ì´í„° ì¶”ì¶œ (Data Export)**

DBì— ìŒ“ì¸ JSONB í˜•ì‹ì˜ `result_payload`ë¥¼ Pandas DataFrame ë“±ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ í•™ìŠµì— í™œìš©í•´ì•¼ í•©ë‹ˆë‹¤.

- **ì°¸ê³  ì¿¼ë¦¬:**SQL
- íŠ¹ì • ë¡œë´‡ì˜ ë°°í„°ë¦¬ ë³€í™” ì¶”ì´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì˜ˆì‹œ
    
    ```sql
    SELECT created_at, (payload>>'value')::float as battery_val
    FROM robot_telemetry
    WHERE data_type = 'battery' AND robot_id = 'EP01';
    ```
    

### **B. ì‹¤ì‹œê°„ ì¶”ë¡  ë¡œì§ í†µí•© (Brain Worker)**

í•™ìŠµëœ ëª¨ë¸(`.pth`, `.onnx`, `.h5` ë“±)ì„ **Brain Worker**ì— íƒ‘ìž¬í•˜ì—¬ ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•©ë‹ˆë‹¤.

- **í†µí•© ìœ„ì¹˜:** `physical_ai/main_server/brain_worker.py` (ì˜ˆì •)
- **ë¡œì§:** ë¦´ë ˆì´ íŒ¨í‚· ìˆ˜ì‹  â†’ ëª¨ë¸ ìž…ë ¥ â†’ ê²°ê³¼ ë„ì¶œ â†’ `worker_to_hub` ì´ë²¤íŠ¸ë¥¼ í†µí•´ Hubë¡œ ì „ì†¡.

---

## 3. íš¨ìœ¨ì ì¸ í˜‘ì—… ì›Œí¬í”Œë¡œìš°

### **Step 1: í™˜ê²½ êµ¬ì„± (Docker)**

AI ëª¨ë¸ì€ ì¢…ì†ì„±(PyTorch, TensorFlow ë“±)ì´ ë§Žìœ¼ë¯€ë¡œ, ë³„ë„ì˜ `Dockerfile.ai`ë¥¼ ìž‘ì„±í•˜ì—¬ ê´€ë¦¬í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

- **ê¶Œìž¥:** GPU ê°€ì†ì´ í•„ìš”í•˜ë‹¤ë©´ `nvidia-docker` ì„¤ì •ì„ ê³ ë ¤í•˜ì„¸ìš”.

### **Step 2: ë°ì´í„° ë¼ë²¨ë§ ë° ì „ì²˜ë¦¬**

- **ê³¼ì œ:** ë¡œë´‡ì˜ ì„¼ì„œ ë°ì´í„°ëŠ” ë…¸ì´ì¦ˆê°€ ë§Žì„ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
- **ê°€ì´ë“œ:** `hub_server.py`ë¥¼ í†µí•´ ë“¤ì–´ì˜¤ëŠ” ì‹¤ì‹œê°„ ë°ì´í„°ë¥¼ ëª¨ë‹ˆí„°ë§í•˜ë©°, ì „ì²˜ë¦¬(Filtering, Scaling) íŒŒì´í”„ë¼ì¸ì„ ë¨¼ì € ì„¤ê³„í•˜ì„¸ìš”.

### **Step 3: ê²°ê³¼ í”¼ë“œë°± ë£¨í”„**

AIê°€ íŒë‹¨í•œ ê²°ê³¼(ì˜ˆ: "ì¶©ëŒ ìœ„í—˜ 80%")ëŠ” UnityíŒ€ì˜ ëŒ€ì‹œë³´ë“œì— ì‹¤ì‹œê°„ìœ¼ë¡œ í‘œì‹œë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

- **ì´ë²¤íŠ¸ ì •ì˜:** `update_data` ë©”ì‹œì§€ ë‚´ì— `type: "ai_prediction"` í˜•ì‹ì„ ì¶”ê°€í•˜ì—¬ ì „ì†¡í•˜ì„¸ìš”.

---

## 4. AIíŒ€ì„ ìœ„í•œ ì²´í¬ë¦¬ìŠ¤íŠ¸ (Best Practices)

- **ë°ì´í„° í¬ë§·:** `payload` ë‚´ì˜ ë°ì´í„° í˜•ì‹ì´ ë³€ê²½ë˜ë©´ í•™ìŠµ ì½”ë“œê°€ ê¹¨ì§ˆ ìˆ˜ ìžˆìœ¼ë¯€ë¡œ DBíŒ€ê³¼ ê¸´ë°€ížˆ ì†Œí†µí•˜ì„¸ìš”.
- **ê²½ëŸ‰í™”:** ìš°ë¦¬ ì‹œìŠ¤í…œì€ ì‹¤ì‹œê°„ì„±(Real-time)ì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ë„ˆë¬´ ë¬´ê±°ìš´ ëª¨ë¸ë³´ë‹¤ëŠ” **TensorRT**ë‚˜ **ONNX**ë¥¼ í™œìš©í•œ ê²½ëŸ‰í™” ëª¨ë¸ ì‚¬ìš©ì„ ê¶Œìž¥í•©ë‹ˆë‹¤.
- **ë²„ì „ ê´€ë¦¬:** í•™ìŠµëœ ëª¨ë¸ ê°€ì¤‘ì¹˜ íŒŒì¼ì€ ìš©ëŸ‰ì´ í¬ë¯€ë¡œ Gitì— ì§ì ‘ ì˜¬ë¦¬ì§€ ë§ê³ , ë³„ë„ì˜ ìŠ¤í† ë¦¬ì§€ë‚˜ `DVC(Data Version Control)` ì‚¬ìš©ì„ ê³ ë ¤í•˜ì„¸ìš”.

---

**ðŸ’¡ AIíŒ€ì—ê²Œ ì „ë‹¬í•  ë©”ì‹œì§€:**

> "ìš°ë¦¬ëŠ” ë‹¨ìˆœí•œ ì›ê²© ì œì–´ë¥¼ ë„˜ì–´ ë¡œë´‡ì´ ìŠ¤ìŠ¤ë¡œ ìƒí™©ì„ íŒë‹¨í•˜ëŠ” ì§€ëŠ¥í˜• ì‹œìŠ¤í…œì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤. DBíŒ€ì´ ìˆ˜ì§‘í•œ ì–‘ì§ˆì˜ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ìš°ë¦¬ë§Œì˜ íŠ¹í™”ëœ ë¡œë´‡ ì œì–´ AI ëª¨ë¸ì„ ì„¤ê³„í•´ ì£¼ì„¸ìš”."
>
