## RoboMaster EP01 통합 사양서

### **[EVENT GROUP] - 상시 실행 서비스 (Daemon)**

데이터 수집

### **이미지 1: `ep01-core-daemon` (기초 데이터 & 상태 감지)**

- **특징**: 경량, 상시 가동.
- **역할**: 로봇의 물리적 신호와 위치 데이터를 json 형식으로 변환 출력.

| **데이터 유형** | **출력 데이터 (Tag)** | **데이터 필드 (JSON)** | **단위 및 설명** |
| --- | --- | --- | --- |
| **배터리 정보** | `battery` | `soc` | 배터리 잔량 ($%$) |
| **위치 정보** | `position` | `x`, `y` | 누적 이동 좌표 ($m$) |
| **속도 정보** | `velocity` | `speed`, `vx`, `vy` | 실시간 이동 속도 ($m/s$) |
| **가속도 정보** | `imu_acc` | `ax`, `ay`, `az` | **3축 가속도.** 들림/충격 분석용 |
| **모터 정보** | `esc_rpm`  | `wheels`  | **모터 RPM (4축).** 바퀴 헛돎/끼임 분석용 |
| **이벤트 알림** | `armor_hit` | `id`, `type` | 아머 타격 위치 및 타입 정보 |
| **시스템 알림** | `status` | `message` | 시스템 시작/종료 등의 로그 메시지 |

### **이미지 2: `ep01-vision-streamer` (비전 이벤트 감지)**

- **특징**: OpenCV 기반, SDK 내장 알고리즘 활용.
- **역할**: 비전 데이터 추출. **high-executor**에 사용될 예정.

| **데이터 유형** | **출력 데이터 (Tag)** | **데이터 필드 (JSON)** | **설명** |
| --- | --- | --- | --- |
| **라인 정보** | `line` | `x`, `angle` | 라인 중심 오차($0 \sim 1.0$) 및 진행 방향 각도 |
| **마커 정보** | `marker` | `id`, `size`, `pos` | 감지된 마커 ID, 화면 점유 면적 및 상대 좌표($x, y$) |
| **이미지 버퍼** | `snapshot` | `path` | 최신 프레임이 저장된 경로 (`/tmp/vision_snapshot.jpg`) |
| **시스템 알림** | `system` | `status`, `message` | 비전 엔진 가동 및 중지 상태 알림 |

---

### **[MISSION GROUP] - 태스크형 작업 (Job)**

필요 시점에만 리소스를 점유하며 실행

### **이미지 3: `ep01-low-executor` (물리 액션 수행)**

- **특징**: `ENTRYPOINT` 파라미터 기반 실행, 동작 완료 후 즉시 종료.
- **역할**: SDK 활용 기본 움직임 제어

| **명령 (Action)** | **주요 파라미터** | **단위 및 설명** |
| --- | --- | --- |
| **`MOVE`** | `--x`, `--y`, `--speed` | Meter(m), Speed(m/s). 정밀 이동 및 속도 제어 |
| **`ROTATE`** | `--yaw`, `--v_speed` | Degree(∘), deg/s. 목표 각도 회전 제어 |
| **`ACTUATOR`** | `--arm_x`, `--arm_y`, `--grip`, `--grip_p` | 로봇 팔 좌표 이동 및 집게 파워(1∼100) 제어 |
| **`FEEDBACK`** | `--r`, `--g`, `--b` | RGB Color. LED를 통한 로봇의 감정/상태 표현 |

### **이미지 4: `ep01-high-intelligence` (고수준 상황 분석)**

- **특징**: 무거운 AI 라이브러리(Mediapipe, YOLO) 포함. 가장 높은 메모리 점유율.
- **역할**: vision-streamer 데이터 기반으로 ai를 적용해 새로 기능을 만들어야 함. **아직 구현&테스트 안함. 아래는 계획**

| **임무 (Task)** | **핵심 기능** | **설명** |
| --- | --- | --- |
| **`AI_RECON`** | 사람 및 제스처 분석 | `PERSON` 위치 파악 및 `WAVE`, `V` 등 제스처 식별 |
| **`SITUATION`** | 상황 요약 보고 (SITREP) | 센서+비전 정보를 통합하여 LLM용 상황 리포트 생성 |
| **`LOG_IMAGE`** | 정밀 캡처 저장 | 특정 이벤트 발생 시 고화질 샷을 클라우드/DB로 전송 |